[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:50:21] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:50:21] Planteles encontrados: 3
[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:50:21] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:50:21] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:50:21] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:21] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:50:21] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:50:21] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:21] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:21] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:50:21] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:21] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:50:21] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:21] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:21] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:21] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:21] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:50:21] Ejecutivos con citas encontrados: 15
[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:21] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:50:43] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:50:43] Planteles encontrados: 3
[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:50:43] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:50:43] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:50:43] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:43] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:50:43] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:50:43] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:43] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:43] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:50:43] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:43] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:50:43] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:43] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:43] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:43] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:43] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:50:43] Ejecutivos con citas encontrados: 15
[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:43] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:50:44] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:50:44] Planteles encontrados: 3
[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:50:44] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:50:44] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:50:44] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:44] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:50:44] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:50:44] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:44] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:50:44] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:50:44] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:44] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:50:44] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:44] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:44] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:50:44] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:50:44] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:50:44] Ejecutivos con citas encontrados: 15
[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:44] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:50:51] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 14
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 20:50:51] ==============================================
[2025-07-21 20:50:51] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 20:50:51] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 14
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 20:50:51] Valores procesados:
[2025-07-21 20:50:51] - ID Ejecutivo: 14
[2025-07-21 20:50:51] - ID Padre: NULL
[2025-07-21 20:50:51] - ID Plantel: 3
[2025-07-21 20:50:51] ANTES - Ejecutivo: Pablo Jimenez, Padre anterior: , Plantel anterior: 6
[2025-07-21 20:50:51] NUEVO PLANTEL: Plantel Ecatepec (ID: 3)
[2025-07-21 20:50:51] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '3' WHERE id_eje = '14'
[2025-07-21 20:50:51] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 3
[2025-07-21 20:50:54] WebSocket cambio plantel enviado
[2025-07-21 20:50:54] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 20:50:54] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 20:50:54] ==============================================
[2025-07-21 20:50:54] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:50:54] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:50:54] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:28] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 10
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 20:54:28] ==============================================
[2025-07-21 20:54:28] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 20:54:28] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 10
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 20:54:28] Valores procesados:
[2025-07-21 20:54:28] - ID Ejecutivo: 10
[2025-07-21 20:54:28] - ID Padre: NULL
[2025-07-21 20:54:28] - ID Plantel: 3
[2025-07-21 20:54:28] ANTES - Ejecutivo: Luis Rodriguez, Padre anterior: , Plantel anterior: 6
[2025-07-21 20:54:28] NUEVO PLANTEL: Plantel Ecatepec (ID: 3)
[2025-07-21 20:54:28] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '3' WHERE id_eje = '10'
[2025-07-21 20:54:28] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 3
[2025-07-21 20:54:31] WebSocket cambio plantel enviado
[2025-07-21 20:54:31] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 20:54:31] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 20:54:31] ==============================================
[2025-07-21 20:54:31] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:54:31] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:54:31] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:54:48] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:54:48] Planteles encontrados: 3
[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:54:48] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:54:48] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:54:48] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:48] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:54:48] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:54:48] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:48] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:48] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:54:48] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:48] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:54:48] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:48] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:48] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:48] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:48] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:54:48] Ejecutivos con citas encontrados: 15
[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:54:48] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:54:49] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:54:49] Planteles encontrados: 3
[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:54:49] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:54:49] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:54:49] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:49] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:54:49] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:54:49] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:49] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:54:49] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:54:49] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:49] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:54:49] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:49] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:49] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:54:49] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:54:49] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:54:49] Ejecutivos con citas encontrados: 15
[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:54:49] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:54:56] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 14
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 20:54:56] ==============================================
[2025-07-21 20:54:56] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 20:54:56] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 14
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 20:54:56] Valores procesados:
[2025-07-21 20:54:56] - ID Ejecutivo: 14
[2025-07-21 20:54:56] - ID Padre: NULL
[2025-07-21 20:54:56] - ID Plantel: 6
[2025-07-21 20:54:56] ANTES - Ejecutivo: Pablo Jimenez, Padre anterior: , Plantel anterior: 3
[2025-07-21 20:54:56] NUEVO PLANTEL: Plantel Cuautitlán (ID: 6)
[2025-07-21 20:54:56] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '6' WHERE id_eje = '14'
[2025-07-21 20:54:56] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 6
[2025-07-21 20:54:59] WebSocket cambio plantel enviado
[2025-07-21 20:54:59] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 20:54:59] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 20:54:59] ==============================================
[2025-07-21 20:54:59] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:54:59] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:54:59] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:56:09] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:56:09] Planteles encontrados: 3
[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:56:09] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:56:09] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:56:09] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:09] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:56:09] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:56:09] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:09] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:09] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:56:09] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:09] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:56:09] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:09] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:09] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:09] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:09] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:56:09] Ejecutivos con citas encontrados: 15
[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:56:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 20:56:10] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 20:56:10] Planteles encontrados: 3
[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 20:56:10] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 20:56:10] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 20:56:10] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:10] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 20:56:10] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 20:56:10] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:10] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 20:56:10] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 20:56:10] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:10] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 20:56:10] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:10] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:10] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 20:56:10] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 20:56:10] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 20:56:10] Ejecutivos con citas encontrados: 15
[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 20:56:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:05:04] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:05:53] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:05:58] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:08:38] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 21:08:38] Planteles encontrados: 3
[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 21:08:38] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 21:08:38] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 21:08:38] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:08:38] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 21:08:38] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 21:08:38] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:08:38] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:08:38] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 21:08:38] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:08:38] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 21:08:38] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:08:38] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:08:38] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:08:38] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:08:38] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 21:08:38] Ejecutivos con citas encontrados: 15
[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:08:38] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:09:09] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 21:09:09] Planteles encontrados: 3
[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

[2025-07-21 21:09:09] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 21:09:09] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 21:09:09] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:09] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 21:09:09] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 21:09:09] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:09] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:09] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 21:09:09] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:09] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 21:09:09] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:09] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:09] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:09] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:09] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 21:09:09] Ejecutivos con citas encontrados: 15
[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:09] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_planteles
)

[2025-07-21 21:09:10] Query planteles: SELECT id_pla, nom_pla, fec_pla FROM plantel ORDER BY nom_pla ASC
[2025-07-21 21:09:10] Planteles encontrados: 3
[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_ejecutivos_con_citas
)

l
    [id_pla] => 2
)

[2025-07-21 21:09:10] Query ejecutivos con citas: SELECT e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje,
					         p.nom_pla as plantel_principal,
					         COUNT(DISTINCT c.id_cit) as citas_propias,
					         GROUP_CONCAT(DISTINCT CONCAT(pa.id_pla, ':', pa.nom_pla) SEPARATOR '|') as planteles_asociados,
					         COUNT(DISTINCT pe.id_pla) as total_planteles_asociados,
					         CASE 
					             WHEN e.ult_eje IS NULL THEN 'sin_sesion'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) <= 1 THEN 'verde'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) BETWEEN 2 AND 3 THEN 'amarillo'
					             WHEN TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) >= 4 THEN 'rojo'
					             ELSE 'sin_sesion'
					         END as semaforo_sesion,
					         TIMESTAMPDIFF(DAY, e.ult_eje, NOW()) as dias_desde_ultima_sesion
					  FROM ejecutivo e 
					  LEFT JOIN plantel p ON e.id_pla = p.id_pla 
					  LEFT JOIN cita c ON e.id_eje = c.id_eje2 AND c.eli_cit = 1 
					  LEFT JOIN planteles_ejecutivo pe ON e.id_eje = pe.id_eje
					  LEFT JOIN plantel pa ON pe.id_pla = pa.id_pla
					  GROUP BY e.id_eje, e.nom_eje, e.tel_eje, e.eli_eje, e.id_padre, e.id_pla, e.ult_eje, p.nom_pla
					  ORDER BY e.eli_eje DESC, e.nom_eje ASC
[2025-07-21 21:09:10] Ejecutivo ID: 9 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 16 - Citas propias: 6 - Citas hijos: 6 - Total: 12
[2025-07-21 21:09:10] Ejecutivo ID: 11 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:10] Ejecutivo ID: 12 - Citas propias: 5 - Citas hijos: 4 - Total: 9
[2025-07-21 21:09:10] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 15 - Citas propias: 7 - Citas hijos: 6 - Total: 13
[2025-07-21 21:09:10] Ejecutivo ID: 18 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:10] Ejecutivo ID: 6 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 4 - Citas propias: 6 - Citas hijos: 0 - Total: 6
[2025-07-21 21:09:10] Ejecutivo ID: 10 - Citas propias: 3 - Citas hijos: 0 - Total: 3
[2025-07-21 21:09:10] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:10] Ejecutivo ID: 2 - Citas propias: 4 - Citas hijos: 5 - Total: 9
[2025-07-21 21:09:10] Ejecutivo ID: 14 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:10] Ejecutivo ID: 21 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:10] Ejecutivo ID: 20 - Citas propias: 5 - Citas hijos: 0 - Total: 5
[2025-07-21 21:09:10] Ejecutivo ID: 13 - Citas propias: 4 - Citas hijos: 0 - Total: 4
[2025-07-21 21:09:10] Ejecutivo ID: 1 - Citas propias: 0 - Citas hijos: 0 - Total: 0
[2025-07-21 21:09:10] Ejecutivos con citas encontrados: 15
[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:10] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:19] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 10
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 21:09:19] ==============================================
[2025-07-21 21:09:19] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 21:09:19] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 10
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 21:09:19] Valores procesados:
[2025-07-21 21:09:19] - ID Ejecutivo: 10
[2025-07-21 21:09:19] - ID Padre: NULL
[2025-07-21 21:09:19] - ID Plantel: 6
[2025-07-21 21:09:19] ANTES - Ejecutivo: Luis Rodriguez, Padre anterior: , Plantel anterior: 3
[2025-07-21 21:09:19] NUEVO PLANTEL: Plantel Cuautitlán (ID: 6)
[2025-07-21 21:09:19] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '6' WHERE id_eje = '10'
[2025-07-21 21:09:19] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 6
[2025-07-21 21:09:19] WebSocket cambio plantel enviado
[2025-07-21 21:09:19] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 21:09:19] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 21:09:19] ==============================================
[2025-07-21 21:09:19] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:19] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:25] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 18
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 21:09:25] ==============================================
[2025-07-21 21:09:25] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 21:09:25] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 18
    [id_padre] => 
    [id_pla] => 3
)

[2025-07-21 21:09:25] Valores procesados:
[2025-07-21 21:09:25] - ID Ejecutivo: 18
[2025-07-21 21:09:25] - ID Padre: NULL
[2025-07-21 21:09:25] - ID Plantel: 3
[2025-07-21 21:09:25] ANTES - Ejecutivo: Eric Valenzuela, Padre anterior: , Plantel anterior: 6
[2025-07-21 21:09:25] NUEVO PLANTEL: Plantel Ecatepec (ID: 3)
[2025-07-21 21:09:25] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '3' WHERE id_eje = '18'
[2025-07-21 21:09:25] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 3
[2025-07-21 21:09:25] WebSocket cambio plantel enviado
[2025-07-21 21:09:25] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 21:09:25] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 21:09:25] ==============================================
[2025-07-21 21:09:25] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:25] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:25] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:27] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 4
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 21:09:27] ==============================================
[2025-07-21 21:09:27] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 21:09:27] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 4
    [id_padre] => 
    [id_pla] => 6
)

[2025-07-21 21:09:27] Valores procesados:
[2025-07-21 21:09:27] - ID Ejecutivo: 4
[2025-07-21 21:09:27] - ID Padre: NULL
[2025-07-21 21:09:27] - ID Plantel: 6
[2025-07-21 21:09:27] ANTES - Ejecutivo: Francisco Pineda, Padre anterior: , Plantel anterior: 3
[2025-07-21 21:09:27] NUEVO PLANTEL: Plantel Cuautitlán (ID: 6)
[2025-07-21 21:09:27] QUERY MOVER: UPDATE ejecutivo SET id_padre = NULL, id_pla = '6' WHERE id_eje = '4'
[2025-07-21 21:09:27] VERIFICACIÓN - Nuevo padre: , Nuevo plantel: 6
[2025-07-21 21:09:27] WebSocket cambio plantel enviado
[2025-07-21 21:09:27] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 21:09:27] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 21:09:27] ==============================================
[2025-07-21 21:09:27] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:27] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

[2025-07-21 21:09:33] REQUEST recibido: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 4
    [id_padre] => 10
    [id_pla] => 6
)

[2025-07-21 21:09:33] ==============================================
[2025-07-21 21:09:33] MOVER EJECUTIVO - REQUEST RECIBIDO
[2025-07-21 21:09:33] POST data completo: Array
(
    [action] => mover_ejecutivo
    [id_eje] => 4
    [id_padre] => 10
    [id_pla] => 6
)

[2025-07-21 21:09:33] Valores procesados:
[2025-07-21 21:09:33] - ID Ejecutivo: 4
[2025-07-21 21:09:33] - ID Padre: 10
[2025-07-21 21:09:33] - ID Plantel: 6
[2025-07-21 21:09:33] ANTES - Ejecutivo: Francisco Pineda, Padre anterior: , Plantel anterior: 6
[2025-07-21 21:09:33] NUEVO PADRE: Luis Rodriguez (ID: 10)
[2025-07-21 21:09:33] NUEVO PLANTEL: Plantel Cuautitlán (ID: 6)
[2025-07-21 21:09:33] QUERY MOVER: UPDATE ejecutivo SET id_padre = '10', id_pla = '6' WHERE id_eje = '4'
[2025-07-21 21:09:33] VERIFICACIÓN - Nuevo padre: 10, Nuevo plantel: 6
[2025-07-21 21:09:33] WebSocket movimiento enviado
[2025-07-21 21:09:33] EJECUTIVO MOVIDO EXITOSAMENTE
[2025-07-21 21:09:33] RESPUESTA ENVIADA: SUCCESS
[2025-07-21 21:09:33] ==============================================
[2025-07-21 21:09:33] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 6
)

[2025-07-21 21:09:33] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 3
)

[2025-07-21 21:09:33] REQUEST recibido: Array
(
    [action] => obtener_citas_totales_por_plantel
    [id_pla] => 2
)

